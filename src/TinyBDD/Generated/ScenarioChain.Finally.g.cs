// <auto-generated/>
namespace TinyBDD;
public sealed partial class ScenarioChain<T>
{
    /// <summary>
    /// Registers a cleanup handler with an explicit title that executes after all steps complete.
    /// The handler receives the current chain value and executes even if subsequent steps fail.
    /// </summary>
    /// <param name="title">Display title for this finally handler.</param>
    /// <param name="effect">Cleanup action that receives the carried value.</param>
    /// <returns>The same <see cref="ScenarioChain{T}"/> for further chaining.</returns>
    public ScenarioChain<T> Finally(string title, Action<T> effect) =>
        FinallyEffect(title, ToCT(effect));

    /// <summary>
    /// Registers a cleanup handler with an explicit title that executes after all steps complete.
    /// The handler receives the current chain value and executes even if subsequent steps fail.
    /// </summary>
    /// <param name="title">Display title for this finally handler.</param>
    /// <param name="effect">Cleanup action that receives the carried value.</param>
    /// <returns>The same <see cref="ScenarioChain{T}"/> for further chaining.</returns>
    public ScenarioChain<T> Finally(string title, Func<T, Task> effect) =>
        FinallyEffect(title, ToCT(effect));

    /// <summary>
    /// Registers a cleanup handler with an explicit title that executes after all steps complete.
    /// The handler receives the current chain value and executes even if subsequent steps fail.
    /// </summary>
    /// <param name="title">Display title for this finally handler.</param>
    /// <param name="effect">Cleanup action that receives the carried value.</param>
    /// <returns>The same <see cref="ScenarioChain{T}"/> for further chaining.</returns>
    public ScenarioChain<T> Finally(string title, Func<T, CancellationToken, Task> effect) =>
        FinallyEffect(title, ToCT(effect));

    /// <summary>
    /// Registers a cleanup handler with an explicit title that executes after all steps complete.
    /// The handler receives the current chain value and executes even if subsequent steps fail.
    /// </summary>
    /// <param name="title">Display title for this finally handler.</param>
    /// <param name="effect">Cleanup action that receives the carried value.</param>
    /// <returns>The same <see cref="ScenarioChain{T}"/> for further chaining.</returns>
    public ScenarioChain<T> Finally(string title, Func<T, ValueTask> effect) =>
        FinallyEffect(title, ToCT(effect));

    /// <summary>
    /// Registers a cleanup handler with an explicit title that executes after all steps complete.
    /// The handler receives the current chain value and executes even if subsequent steps fail.
    /// </summary>
    /// <param name="title">Display title for this finally handler.</param>
    /// <param name="effect">Cleanup action that receives the carried value.</param>
    /// <returns>The same <see cref="ScenarioChain{T}"/> for further chaining.</returns>
    public ScenarioChain<T> Finally(string title, Func<T, CancellationToken, ValueTask> effect) =>
        FinallyEffect(title, ToCT(effect));

    /// <summary>
    /// Registers a cleanup handler  that executes after all steps complete.
    /// The handler receives the current chain value and executes even if subsequent steps fail.
    /// </summary>
    /// <param name="effect">Cleanup action that receives the carried value.</param>
    /// <returns>The same <see cref="ScenarioChain{T}"/> for further chaining.</returns>
    public ScenarioChain<T> Finally(Action<T> effect) =>
        FinallyEffect(string.Empty, ToCT(effect));

    /// <summary>
    /// Registers a cleanup handler  that executes after all steps complete.
    /// The handler receives the current chain value and executes even if subsequent steps fail.
    /// </summary>
    /// <param name="effect">Cleanup action that receives the carried value.</param>
    /// <returns>The same <see cref="ScenarioChain{T}"/> for further chaining.</returns>
    public ScenarioChain<T> Finally(Func<T, Task> effect) =>
        FinallyEffect(string.Empty, ToCT(effect));

    /// <summary>
    /// Registers a cleanup handler  that executes after all steps complete.
    /// The handler receives the current chain value and executes even if subsequent steps fail.
    /// </summary>
    /// <param name="effect">Cleanup action that receives the carried value.</param>
    /// <returns>The same <see cref="ScenarioChain{T}"/> for further chaining.</returns>
    public ScenarioChain<T> Finally(Func<T, CancellationToken, Task> effect) =>
        FinallyEffect(string.Empty, ToCT(effect));

    /// <summary>
    /// Registers a cleanup handler  that executes after all steps complete.
    /// The handler receives the current chain value and executes even if subsequent steps fail.
    /// </summary>
    /// <param name="effect">Cleanup action that receives the carried value.</param>
    /// <returns>The same <see cref="ScenarioChain{T}"/> for further chaining.</returns>
    public ScenarioChain<T> Finally(Func<T, ValueTask> effect) =>
        FinallyEffect(string.Empty, ToCT(effect));

    /// <summary>
    /// Registers a cleanup handler  that executes after all steps complete.
    /// The handler receives the current chain value and executes even if subsequent steps fail.
    /// </summary>
    /// <param name="effect">Cleanup action that receives the carried value.</param>
    /// <returns>The same <see cref="ScenarioChain{T}"/> for further chaining.</returns>
    public ScenarioChain<T> Finally(Func<T, CancellationToken, ValueTask> effect) =>
        FinallyEffect(string.Empty, ToCT(effect));

}
